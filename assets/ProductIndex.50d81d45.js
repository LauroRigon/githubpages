import{bw as T,Y as V,bc as A,r as I,w as B,aE as L,H as R,I as $,a1 as h,J as t,K as o,a2 as l,a0 as n,aF as z,A as F,M as p,$ as y,b8 as H}from"./index.0c1b9320.js";import{Q as M}from"./QInnerLoading.e500c865.js";import{Q as u}from"./QTd.ae6a459c.js";import{Q as q}from"./QTable.2b218a80.js";import{a as J,P as _}from"./ProductModel.a6fb0bb7.js";import{n as w,a as K}from"./NotifyHelper.aabcb271.js";import{u as O}from"./usePaginatedResourceListing.ce68d7c3.js";import{f as x}from"./CurrencyHelper.14a540bf.js";import"./QList.7d15dc0d.js";import"./QSelect.7759fa6b.js";import"./QMenu.795138f0.js";async function U(f,r,c,m){return new Promise(s=>{T.create({title:f,message:r,cancel:!0,ok:m,color:c}).onOk(()=>{s(!0)}).onCancel(()=>{s(!1)}).onDismiss(()=>{s(!1)})})}var Y={confirm:U};const j={class:"row"},G={class:"col q-pb-sm"},W=p(" Adicionar "),ce=V({__name:"ProductIndex",async setup(f){let r,c;const m=A(),s=[{name:"name",label:"Nome",align:"left",field:"name"},{name:"type",label:"Tipo",field:"type",align:"center",headerStyle:"width: 100px"},{name:"cost",label:"Custo",field:"cost",align:"center",format:e=>x(e),headerStyle:"width: 100px"},{name:"price",align:"center",label:"Pre\xE7o",field:"price",format:e=>x(e),headerStyle:"width: 100px"},{name:"percentage",align:"center",label:"Porcentagem",field:"percentage",headerStyle:"width: 100px"},{name:"actions",align:"center",label:"A\xE7\xF5es",field:"actions"}],d=I(null);B(d,async()=>await g());const{fetchData:g,fetchNextPage:b,fetchPreviousPage:P,hasPreviousPage:v,hasNextPage:C,data:k,isLoading:N}=([r,c]=L(async()=>O(async e=>await _.list({cursor:e,name:d.value}),e=>w(e.response&&e.response.data.message))),r=await r,c(),r);function Q(e,i){return i<0?0:Math.round((e*100/i-100)*-1)}function D(e){m.push({name:"product.edit",params:{id:e.id}})}async function E(e){if(!!await Y.confirm(e.name,"Remover produto?","red","Confirmar"))try{await _.remove(e.id),K("Produto exclu\xEDdo"),await g()}catch(a){if(!H.isAxiosError(a))throw a;w(a.response&&a.response.data.message)}}return(e,i)=>(R(),$("div",null,[h("div",j,[h("div",G,[t(l,{type:"button",color:"primary",icon:"add",to:{name:"product.create"}},{default:o(()=>[W]),_:1},8,["to"])])]),t(q,{title:"Produtos","row-key":"name",rows:n(k),columns:s,loading:n(N),"rows-per-page-options":[0]},{loading:o(()=>[t(M,{showing:"",color:"primary"})]),"top-right":o(()=>[t(z,{modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=a=>d.value=a),placeholder:"Nome do produto",debounce:300},{append:o(()=>[t(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-type":o(({row:a})=>[t(u,{class:"text-center"},{default:o(()=>[p(y(n(J)[a.type]),1)]),_:2},1024)]),"body-cell-percentage":o(({row:a})=>[t(u,{class:"text-center"},{default:o(()=>[p(y(Q(a.cost,a.price))+"% ",1)]),_:2},1024)]),"body-cell-actions":o(({row:a})=>[t(u,{"auto-width":""},{default:o(()=>[t(l,{color:"warning",size:"xs",icon:"edit",onClick:S=>D(a)},null,8,["onClick"]),t(l,{color:"red",size:"xs",icon:"delete",onClick:S=>E(a)},null,8,["onClick"])]),_:2},1024)]),pagination:o(()=>[t(l,{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:!n(v),onClick:n(P)},null,8,["disable","onClick"]),t(l,{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:!n(C),onClick:n(b)},null,8,["disable","onClick"])]),_:1},8,["rows","loading"])]))}});export{ce as default};
